#
# k8s-cms
# Kubernetes Intergration
#

namespace: k8s-cms
commonLabels:
  app: k8s-cms
  version: rolling
  release: alpha
  envionment: dev

configMapGenerator:
  - name: cms-config-env
    env: "config/config.env"
  - name: cms-config
    files:
      - "config/cms.conf"
      - "config/cms.ranking.conf"
      - "config/nginx.conf"
    
secretGenerator:
  - name: cms-secrets
    env: ".env"

resources:
  - "k8s/namespace.yml"

  # service account and role based access control
  - "k8s/rbac/service-account.yml"
  
  # database
  - "k8s/deployments/database.yml"
  - "k8s/services/database.yml"
  - "k8s/storage/database-data.yml"

  # cms resources service
  - "k8s/deployments/cms-resources.yml"
  - "k8s/services/cms-resources.yml"
    
  # cms logging service
  - "k8s/deployments/cms-logging.yml"
  - "k8s/services/cms-logging.yml"
   
  # cms scoring service
  - "k8s/deployments/cms-scoring.yml"
  - "k8s/services/cms-scoring.yml"
    
  # cms evaluation service
  - "k8s/deployments/cms-evaluation.yml"
  - "k8s/services/cms-evaluation.yml"

  # cms proxy service  
  - "k8s/deployments/cms-proxy.yml"
  - "k8s/services/cms-proxy.yml"
    
  # cms web admin interface
  - "k8s/deployments/cms-web-admin.yml"
  - "k8s/services/cms-admin.yml"
  - "k8s/services/cms-web-admin.yml"

  # cms printing service
  - "k8s/deployments/cms-printing.yml"
  - "k8s/services/cms-printing.yml"

  # cms web ranking interface
  - "k8s/deployments/cms-web-ranking.yml"
  - "k8s/services/cms-ranking.yml"
  - "k8s/services/cms-web-ranking.yml"

  # cms checking service
  - "k8s/deployments/cms-checker.yml"
  - "k8s/services/cms-checker.yml"

  # cms web contest interface
  - "k8s/deployments/cms-web-contest.yml"
  - "k8s/services/cms-contest.yml"
  - "k8s/services/cms-web-contest.yml"
  
  # cms workers
  - "k8s/deployments/cms-worker.yml"
  - "k8s/services/cms-worker.yml"
  # worker configmap
  - "k8s/config/config-worker.yml"

  # ingress
  - "k8s/ingress.yml"
  
patchesStrategicMerge:
  - "k8s/config/config-env.yml"

# image versioning
images:
  - name: mrzzy/postgres
    newTag: "0.2.1b"
  - name: mrzzy/cms-db
    newTag: "0.2.1b"
  - name: mrzzy/cms-resource
    newTag: "0.2.1b"
  - name: mrzzy/cms-log
    newTag: "0.2.1b"
  - name: mrzzy/cms-scoring
    newTag: "0.2.1b"
  - name: mrzzy/cms-evaluation
    newTag: "0.2.1b"
  - name: mrzzy/cms-proxy
    newTag: "0.2.1b"
  - name: mrzzy/cms-web-admin
    newTag: "0.2.1b"
  - name: mrzzy/cms-printing
    newTag: "0.2.1b"
  - name: mrzzy/cms-web-ranking
    newTag: "0.2.1b"
  - name: mrzzy/cms-checker
    newTag: "0.2.1b"
  - name: mrzzy/cms-web-contest
    newTag: "0.2.1b"
  - name: mrzzy/cms-worker
    newTag: "0.2.1b"
